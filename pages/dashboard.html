<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Celestial Timeline</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Outfit:wght@300;500;700&family=Cinzel:wght@600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* ============================
           1. MASTER DESIGN SYSTEM
           ============================ */
        :root {
            --primary: #ff005c;
            --primary-glow: rgba(255, 0, 92, 0.5);
            --glass: rgba(255, 255, 255, 0.65);
            --glass-strong: rgba(255, 255, 255, 0.85);
            --border: rgba(255, 255, 255, 0.9);
            --text: #4a0418;
            --bg-grad: linear-gradient(120deg, #ff9a9e 0%, #fecfef 50%, #fff0f3 100%);
        }

        html { scroll-behavior: smooth; }
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Outfit', sans-serif;
            color: var(--text);
            overflow-x: hidden;
            padding-bottom: 120px;
            background: var(--bg-grad);
            background-size: 200% 200%;
            animation: aurora 15s ease infinite;
        }
        @keyframes aurora {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* CUSTOM CURSOR TRAIL */
        .trail-heart {
            position: fixed; font-size: 1rem; color: var(--primary);
            pointer-events: none; animation: fadeUp 1s forwards; z-index: 9999;
        }
        @keyframes fadeUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-50px) scale(0); }
        }

        /* LOADING SCREEN */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff0f3; z-index: 5000;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.2s ease;
        }
        .heart-beat-loader { font-size: 4rem; color: var(--primary); animation: pulse 0.5s infinite; }

        /* ============================
           2. HEADER & NAV
           ============================ */
        .navbar {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(20px);
            padding: 15px 5%;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid white;
            box-shadow: 0 5px 20px rgba(0,0,0,0.03);
        }
        .brand { font-family: 'Great Vibes', cursive; font-size: 2.2rem; color: var(--primary); }

        .profile-pill {
            background: rgba(255,255,255,0.6); padding: 5px 15px 5px 5px;
            border-radius: 50px; border: 1px solid white; display: flex; align-items: center; gap: 10px;
        }
        .profile-pill img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary); }

        /* ============================
           3. TIMELINE LAYOUT
           ============================ */
        .timeline-wrapper {
            max-width: 800px; margin: 0 auto;
            position: relative; padding: 40px 20px;
        }

        /* The Dotted Line */
        .timeline-line {
            position: absolute; left: 50%; top: 0; bottom: 0;
            width: 2px; background-image: linear-gradient(to bottom, var(--primary) 50%, transparent 50%);
            background-size: 2px 20px; z-index: -1; opacity: 0.5;
            transform: translateX(-50%);
        }

        .section-container {
            margin: 60px 0;
            opacity: 0; transform: translateY(50px);
            transition: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            position: relative;
        }
        .section-container.visible { opacity: 1; transform: translateY(0); }

        /* Section Number Bubble */
        .timeline-dot {
            position: absolute; left: 50%; top: -20px;
            transform: translateX(-50%);
            width: 40px; height: 40px; background: var(--primary); color: white;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: 700; border: 4px solid #fff0f3; z-index: 10;
        }

        .content-box {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 30px; padding: 40px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(255, 0, 92, 0.1);
            position: relative; backdrop-filter: blur(15px);
            transform-style: preserve-3d; transition: transform 0.1s;
        }

        /* Holographic Shine */
        .content-box::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.5) 0%, transparent 50%);
            border-radius: 30px; pointer-events: none;
        }

        .section-title {
            font-family: 'Great Vibes', cursive; font-size: 3rem;
            color: var(--primary); margin-bottom: 10px;
        }

        .section-icon { font-size: 4rem; display: block; margin-bottom: 15px; text-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        .magic-btn {
            display: inline-block; padding: 12px 35px;
            background: linear-gradient(45deg, #ff005c, #ff5c8d);
            color: white; text-decoration: none; border-radius: 50px;
            font-weight: 700; font-size: 1rem; margin-top: 20px;
            box-shadow: 0 10px 20px rgba(255, 0, 92, 0.3);
            transition: 0.3s;
        }
        .magic-btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 15px 30px rgba(255, 0, 92, 0.4); }

        /* LOCKED STATE */
        .locked-section { filter: grayscale(1); opacity: 0.8; pointer-events: none; }
        .locked-section .content-box::after {
            content: "üîí LOCKED"; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); color: white;
            padding: 10px 20px; border-radius: 12px; font-weight: 700;
        }

        /* ============================
           4. NEW ELEMENTS (NAMES & MARQUEE)
           ============================ */
        
        /* THE COUPLE BADGE (Replaces Timer) */
        .couple-badge {
            position: relative;
            display: inline-block;
            padding: 40px;
            margin-top: 20px;
        }
        .couple-ring {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            border: 2px dashed var(--primary); border-radius: 50%;
            animation: spinSlow 20s linear infinite;
        }
        @keyframes spinSlow { 100% { transform: rotate(360deg); } }
        
        .couple-names {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: var(--primary);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative; z-index: 2;
        }
        .heart-separator { color: var(--primary); animation: pulse 1s infinite; display: inline-block; margin: 0 10px; }

        /* SEND LOVE BUTTON */
        .send-love-btn {
            background: white; border: 2px solid var(--primary); color: var(--primary);
            padding: 10px 25px; border-radius: 30px; cursor: pointer;
            margin-top: 20px; font-weight: 700; transition: 0.3s;
        }
        .send-love-btn:hover { background: var(--primary); color: white; }

        /* INFINITE MARQUEE (Love Notes) */
        .marquee-wrapper {
            width: 100%; overflow: hidden; position: relative;
            padding: 20px 0; mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
        }
        .marquee-content {
            display: flex; gap: 30px; width: max-content;
            animation: scrollLeft 30s linear infinite;
        }
        .marquee-content:hover { animation-play-state: paused; }

        @keyframes scrollLeft {
            to { transform: translateX(-50%); }
        }

        .note-card {
            background: white; padding: 20px 30px; border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); white-space: nowrap;
            font-style: italic; color: #555; border: 1px solid white;
        }
        .note-card:nth-child(even) { background: #fff0f3; color: var(--primary); }

        /* ============================
           5. MUSIC PLAYER
           ============================ */
        .music-float {
            position: fixed; bottom: 30px; right: 30px;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(15px);
            padding: 15px 25px; border-radius: 50px;
            display: flex; align-items: center; gap: 15px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15); z-index: 2000;
            border: 1px solid white; transition: 0.3s;
        }
        .music-float:hover { transform: scale(1.05); }

        .visualizer { display: flex; gap: 3px; height: 20px; align-items: flex-end; }
        .bar { width: 3px; background: var(--primary); animation: sound 0.5s infinite alternate; }
        .bar:nth-child(2) { animation-delay: 0.1s; height: 15px; }
        .bar:nth-child(3) { animation-delay: 0.3s; height: 10px; }
        @keyframes sound { 0% { height: 5px; } 100% { height: 20px; } }
        .paused .bar { animation-play-state: paused; height: 5px; }

        .ctrl-btn {
            background: var(--primary); color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%;
            cursor: pointer; font-size: 1rem;
        }

        footer { text-align: center; margin-top: 50px; color: #888; }

    </style>
</head>
<body>

    <div id="loader"><i class="fas fa-heart heart-beat-loader"></i></div>

    <nav class="navbar">
        <div class="brand">Celestial</div>
        <div class="profile-pill">
            <span class="dynamic-name">Love</span>
            <img id="nav-photo" src="https://via.placeholder.com/50" alt="Profile">
        </div>
    </nav>

    <div class="timeline-wrapper">
        <div class="timeline-line"></div>

        <div class="section-container visible">
            <div class="timeline-dot">‚ù§Ô∏è</div>
            <div class="content-box" style="background: linear-gradient(135deg, #ff9a9e, #fecfef);">
                <h1 style="font-family:'Great Vibes'; font-size:3rem; color:white;">Our Universe</h1>
                
                <div class="couple-badge">
                    <div class="couple-names">
                        Me <span class="heart-separator">‚ù§Ô∏è</span> <span class="dynamic-name">You</span>
                    </div>
                </div>

                <p style="color:white; margin-top:20px;">Together, we are infinite.</p>

                <button class="send-love-btn" id="send-love-trigger">
                    <i class="fas fa-paper-plane"></i> Send Love
                </button>
            </div>
        </div>

        <div class="section-container">
            <div class="timeline-dot">‚ÑπÔ∏è</div>
            <div class="content-box">
                <h2 class="section-title">Our Story</h2>
                <p style="font-size:1.1rem; line-height:1.6; color:#666;">
                    "In all the world, there is no heart for me like yours. In all the world, there is no love for you like mine."
                </p>
            </div>
        </div>

        <div class="section-container" id="sec-rose" data-date="2026-02-07">
            <div class="timeline-dot">1</div>
            <div class="content-box">
                <span class="section-icon">üåπ</span>
                <h2 class="section-title">Rose Day</h2>
                <p>The beginning of something beautiful.</p>
                <a href="./pages/rose_day.html" class="magic-btn">Open Rose</a>
            </div>
        </div>

        <div class="section-container" id="sec-propose" data-date="2026-02-08">
            <div class="timeline-dot">2</div>
            <div class="content-box">
                <span class="section-icon">üíç</span>
                <h2 class="section-title">Propose Day</h2>
                <p>A question that changes everything.</p>
                <a href="./pages/propose_day.html" class="magic-btn">View Proposal</a>
            </div>
        </div>

        <div class="section-container" id="sec-choco" data-date="2026-02-09">
            <div class="timeline-dot">3</div>
            <div class="content-box">
                <span class="section-icon">üç´</span>
                <h2 class="section-title">Chocolate Day</h2>
                <p>Sweet treats for my sweetest.</p>
                <a href="./pages/chocolate_day.html" class="magic-btn">Unwrap</a>
            </div>
        </div>

        <div class="section-container" id="sec-teddy" data-date="2026-02-10">
            <div class="timeline-dot">4</div>
            <div class="content-box">
                <span class="section-icon">üß∏</span>
                <h2 class="section-title">Teddy Day</h2>
                <p>Soft hugs and warm cuddles.</p>
                <a href="./pages/teddy_day.html" class="magic-btn">Hug Me</a>
            </div>
        </div>

        <div class="section-container" id="sec-promise" data-date="2026-02-11">
            <div class="timeline-dot">5</div>
            <div class="content-box">
                <span class="section-icon">ü§ù</span>
                <h2 class="section-title">Promise Day</h2>
                <p>My vows to you, forever kept.</p>
                <a href="./pages/promise_day.html" class="magic-btn">Read Vows</a>
            </div>
        </div>

        <div class="section-container" id="sec-hug" data-date="2026-02-12">
            <div class="timeline-dot">6</div>
            <div class="content-box">
                <span class="section-icon">ü´Ç</span>
                <h2 class="section-title">Hug Day</h2>
                <p>Safe in your arms.</p>
                <a href="./pages/hug_day.html" class="magic-btn">Come Closer</a>
            </div>
        </div>

        <div class="section-container" id="sec-kiss" data-date="2026-02-13">
            <div class="timeline-dot">7</div>
            <div class="content-box">
                <span class="section-icon">üíã</span>
                <h2 class="section-title">Kiss Day</h2>
                <p>Sealed with a touch.</p>
                <a href="./pages/kiss_day.html" class="magic-btn">Receive Kiss</a>
            </div>
        </div>

        <div class="section-container" id="sec-val" data-date="2026-02-14">
            <div class="timeline-dot">‚ù§Ô∏è</div>
            <div class="content-box" style="border: 3px solid var(--primary); background: #fff0f3;">
                <span class="section-icon">üíñ</span>
                <h2 class="section-title">Valentine's Day</h2>
                <p>The Grand Finale of Us.</p>
                <a href="./pages/valentine.html" class="magic-btn">Enter Paradise</a>
            </div>
        </div>

        <div class="section-container">
            <div class="timeline-dot">üíå</div>
            <div class="content-box">
                <h2 class="section-title">Whispers</h2>
                
                <div class="marquee-wrapper">
                    <div class="marquee-content">
                        <div class="note-card">"You are my sun, my moon, and all my stars."</div>
                        <div class="note-card">"I love you more than yesterday."</div>
                        <div class="note-card">"Every day with you is my favorite day."</div>
                        <div class="note-card">"You are the best thing I never planned."</div>
                        <div class="note-card">"My heart is perfect because you are inside."</div>
                        <div class="note-card">"You are my sun, my moon, and all my stars."</div>
                        <div class="note-card">"I love you more than yesterday."</div>
                        <div class="note-card">"Every day with you is my favorite day."</div>
                        <div class="note-card">"You are the best thing I never planned."</div>
                        <div class="note-card">"My heart is perfect because you are inside."</div>
                    </div>
                </div>

            </div>
        </div>

        <div class="section-container" style="text-align:center;">
             <i class="fas fa-heart" style="font-size:5rem; color:var(--primary); animation:pulse 1s infinite;"></i>
             <p style="margin-top:20px; color:#999;">Forever & Always</p>
        </div>

    </div>

    <div class="music-float">
        <div class="visualizer paused" id="visualizer">
            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
        </div>
        <div style="line-height:1.2;">
            <div style="font-weight:700; color:var(--primary);" id="song-title">Love Song</div>
            <div style="font-size:0.75rem; color:#666;">Playlist Ready</div>
        </div>
        <button class="ctrl-btn" id="shuffle-btn"><i class="fas fa-random"></i></button>
        <button class="ctrl-btn" id="play-btn"><i class="fas fa-play"></i></button>
    </div>

    <audio id="audio-player"></audio>

    <footer>
        Developed and Managed by <span style="color:red;">‚ù§Ô∏è</span> My Love
        <br>
        <a href="../index.html" style="font-size:0.8rem; color:#ccc; text-decoration:none; display:inline-block; margin-top:10px;">Exit</a>
    </footer>

    <script type="module" src="../js/app.js"></script>

    <script type="module" src="../js/app.js"></script>

    <script type="module">
        import { getUserData } from '../js/modules/storage.js';

        // 1. INSTANT LOADER (Fixed)
        // Immediately fade out the loader when the page structure is ready
        document.addEventListener('DOMContentLoaded', () => {
            const loader = document.getElementById('loader');
            if(loader) {
                loader.style.transition = "opacity 0.5s";
                loader.style.opacity = '0';
                // Remove it from the DOM quickly so it doesn't block clicks
                setTimeout(() => loader.remove(), 500);
            }
        });

        // 2. DATA LOAD (Fast)
        const user = getUserData();
        if (user && user.name) document.querySelector('.dynamic-name').innerText = user.name;
        if (user && user.photo) document.getElementById('nav-photo').src = user.photo;

        // 3. MOUSE HEART TRAIL (Optimized)
        let throttleTimer;
        document.addEventListener('mousemove', function(e) {
            if(throttleTimer) return; // Limit hearts to improve speed
            throttleTimer = setTimeout(() => {
                const heart = document.createElement('div');
                heart.classList.add('trail-heart');
                heart.innerHTML = '‚ù§Ô∏è';
                heart.style.left = e.pageX + 'px';
                heart.style.top = e.pageY + 'px';
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 1000);
                throttleTimer = null;
            }, 50); // Only create a heart every 50ms
        });

        // 4. SCROLL ANIMATION (Trigger Immediately)
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('visible');
            });
        }, { threshold: 0.01 }); // Trigger as soon as 1% is visible
        
        document.querySelectorAll('.section-container').forEach(sec => {
            observer.observe(sec);
            // Force visible immediately if it's the top section
            if(sec.getBoundingClientRect().top < window.innerHeight) {
                sec.classList.add('visible');
            }
        });

        // 5. MUSIC & SHUFFLE
        const playlist = [
            { title: "Raabta", src: "assets/audio/Raabta.mp3" },
            // { title: "Thousand Years", src: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" },
            // { title: "All of Me", src: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" }
        ];
        const audio = document.getElementById('audio-player');
        const playBtn = document.getElementById('play-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const vis = document.getElementById('visualizer');
        const titleEl = document.getElementById('song-title');
        let isPlaying = false;

        playBtn.addEventListener('click', () => {
            if (!audio.src) audio.src = playlist[0].src;
            if(isPlaying) {
                audio.pause();
                playBtn.innerHTML = '<i class="fas fa-play"></i>';
                vis.classList.add('paused');
            } else {
                audio.play();
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                vis.classList.remove('paused');
            }
            isPlaying = !isPlaying;
        });

        shuffleBtn.addEventListener('click', () => {
            const rand = Math.floor(Math.random() * playlist.length);
            audio.src = playlist[rand].src;
            titleEl.innerText = playlist[rand].title;
            audio.play();
            isPlaying = true;
            playBtn.innerHTML = '<i class="fas fa-pause"></i>';
            vis.classList.remove('paused');
        });

        // 6. DATE LOCKING (Optimized for GitHub & Local Time)
const today = new Date();
const todayStr = today.getFullYear() + '-' + 
                 String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                 String(today.getDate()).padStart(2, '0');

const locks = [
    {id:'sec-rose', date:'2026-02-07', file:'rose_day.html'},
    {id:'sec-propose', date:'2026-02-08', file:'propose_day.html'},
    {id:'sec-choco', date:'2026-02-09', file:'chocolate_day.html'},
    {id:'sec-teddy', date:'2026-02-10', file:'teddy_day.html'},
    {id:'sec-promise', date:'2026-02-11', file:'promise_day.html'},
    {id:'sec-hug', date:'2026-02-12', file:'hug_day.html'},
    {id:'sec-kiss', date:'2026-02-13', file:'kiss_day.html'},
    {id:'sec-val', date:'2026-02-14', file:'valentine.html'}
];

locks.forEach(l => {
    const el = document.getElementById(l.id);
    if (!el) return;

    const btn = el.querySelector('.magic-btn');
    
    if (todayStr < l.date) {
        // --- LOCKED ---
        el.classList.add('locked-section');
        el.style.filter = "grayscale(1)";
        if (btn) {
            btn.innerText = "Locked";
            // Uses lowercase 'pages' and relative path
            btn.href = "coming_soon.html"; 
        }
    } else {
        // --- UNLOCKED (Feb 6 & 7 should be open now) ---
        el.classList.remove('locked-section');
        el.style.filter = "none";
        el.style.opacity = "1";
        if (btn) {
            btn.href = l.file; // Link directly to the file in the same folder
            btn.innerText = "Open " + l.id.replace('sec-', '').charAt(0).toUpperCase() + l.id.replace('sec-', '').slice(1);
        }
    }
});
        // 7. SEND LOVE BUTTON
        const sendBtn = document.getElementById('send-love-trigger');
        if(sendBtn) {
            sendBtn.addEventListener('click', () => {
                 confetti({
                    particleCount: 150,
                    spread: 100,
                    origin: { y: 0.6 },
                    colors: ['#ff005c', '#ff5c8d', '#ffffff'],
                    shapes: ['circle', 'heart']
                });
            });
        }
    </script>
</body>
</html>